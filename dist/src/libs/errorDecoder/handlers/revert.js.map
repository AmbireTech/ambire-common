{"version":3,"file":"revert.js","sourceRoot":"","sources":["../../../../../src/libs/errorDecoder/handlers/revert.ts"],"names":[],"mappings":";;AAAA,2CAA2C;AAC3C,mCAAgD;AAEhD,4CAA2C;AAC3C,oCAAgE;AAEhE,MAAM,kBAAkB;IACf,OAAO,CAAC,IAAY;QACzB,OAAO,IAAI,EAAE,UAAU,CAAC,wBAAY,CAAC,CAAA;IACvC,CAAC;IAEM,MAAM,CAAC,IAAY;QACxB,MAAM,aAAa,GAAG,IAAI,CAAC,KAAK,CAAC,wBAAY,CAAC,MAAM,CAAC,CAAA;QACrD,MAAM,GAAG,GAAG,IAAI,iBAAQ,EAAE,CAAA;QAC1B,IAAI,CAAC;YACH,MAAM,QAAQ,GAAG,sBAAa,CAAC,IAAI,CAAC,eAAe,CAAC,CAAA;YACpD,MAAM,IAAI,GAAG,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,EAAE,KAAK,aAAa,EAAE,CAAC,CAAA;YAC9D,MAAM,MAAM,GAAG,IAAI,CAAC,CAAC,CAAW,CAAA;YAEhC,OAAO;gBACL,IAAI,EAAE,iBAAS,CAAC,WAAW;gBAC3B,MAAM;gBACN,IAAI;aACL,CAAA;QACH,CAAC;QAAC,OAAO,CAAC,EAAE,CAAC;YACX,OAAO,CAAC,KAAK,CAAC,+BAA+B,EAAE,CAAC,CAAC,CAAA;YAEjD,OAAO;gBACL,IAAI,EAAE,iBAAS,CAAC,WAAW;gBAC3B,MAAM,EAAE,EAAE;gBACV,IAAI;aACL,CAAA;QACH,CAAC;IACH,CAAC;CACF;AAED,kBAAe,kBAAkB,CAAA","sourcesContent":["/* eslint-disable class-methods-use-this */\nimport { AbiCoder, ErrorFragment } from 'ethers'\n\nimport { ERROR_PREFIX } from '../constants'\nimport { DecodedError, ErrorHandler, ErrorType } from '../types'\n\nclass RevertErrorHandler implements ErrorHandler {\n  public matches(data: string): boolean {\n    return data?.startsWith(ERROR_PREFIX)\n  }\n\n  public handle(data: string): DecodedError {\n    const encodedReason = data.slice(ERROR_PREFIX.length)\n    const abi = new AbiCoder()\n    try {\n      const fragment = ErrorFragment.from('Error(string)')\n      const args = abi.decode(fragment.inputs, `0x${encodedReason}`)\n      const reason = args[0] as string\n\n      return {\n        type: ErrorType.RevertError,\n        reason,\n        data\n      }\n    } catch (e) {\n      console.error('Failed to decode revert error', e)\n\n      return {\n        type: ErrorType.RevertError,\n        reason: '',\n        data\n      }\n    }\n  }\n}\n\nexport default RevertErrorHandler\n"]}