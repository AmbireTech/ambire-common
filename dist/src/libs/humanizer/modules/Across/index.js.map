{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../../../src/libs/humanizer/modules/Across/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { Interface } from 'ethers'\n\nimport { AccountOp } from '../../../accountOp/accountOp'\nimport { Across } from '../../const/abis'\nimport { HumanizerCallModule, IrCall } from '../../interfaces'\nimport {\n  getAction,\n  getChain,\n  getDeadline,\n  getLabel,\n  getRecipientText,\n  getToken,\n  getTokenWithChain\n} from '../../utils'\n\nconst AcrossModule: HumanizerCallModule = (accOp: AccountOp, calls: IrCall[]) => {\n  const iface = new Interface(Across)\n  const matcher = {\n    [iface.getFunction(\n      'depositV3(address depositor,address recipient,address inputToken,address outputToken,uint256 inputAmount,uint256 outputAmount,uint256 destinationChainId,address exclusiveRelayer,uint32 quoteTimestamp,uint32 fillDeadline,uint32 exclusivityDeadline,bytes calldata message)'\n    )?.selector!]: (call: IrCall) => {\n      const {\n        recipient,\n        inputToken,\n        outputToken,\n        inputAmount,\n        outputAmount,\n        destinationChainId,\n        fillDeadline\n      } = iface.parseTransaction(call)!.args\n      return [\n        getAction('Bridge'),\n        getToken(inputToken, inputAmount),\n        getLabel('for'),\n        getTokenWithChain(outputToken, outputAmount, destinationChainId),\n        getLabel('to'),\n        getChain(destinationChainId),\n        getDeadline(fillDeadline),\n        ...getRecipientText(accOp.accountAddr, recipient)\n      ]\n    },\n    [iface.getFunction(\n      'deposit(address recipient,address originToken,uint256 amount,uint256 destinationChainId,int64 relayerFeePct,uint32 quoteTimestamp,bytes memory message,uint256 maxCount)'\n    )?.selector!]: (call: IrCall) => {\n      const { recipient, originToken, amount, destinationChainId } =\n        iface.parseTransaction(call)!.args\n      return [\n        getAction('Bridge'),\n        getToken(originToken, amount),\n        getLabel('to'),\n        getChain(destinationChainId),\n        ...getRecipientText(accOp.accountAddr, recipient)\n      ]\n    },\n    [iface.getFunction(\n      'function deposit(address spokePool,address recipient, address originToken, uint256 amount, uint256 destinationChainId, int64 relayerFeePct, uint32 quoteTimestamp,bytes message, uint256 maxCount) payable'\n    )?.selector!]: (call: IrCall) => {\n      const { recipient, originToken, amount, destinationChainId } =\n        iface.parseTransaction(call)!.args\n\n      return [\n        getAction('Bridge'),\n        getToken(originToken, amount),\n        getLabel('to'),\n        getChain(destinationChainId),\n        ...getRecipientText(accOp.accountAddr, recipient)\n      ]\n    }\n  }\n  const newCalls = calls.map((call) => {\n    if (call.fullVisualization || !matcher[call.data.slice(0, 10)]) return call\n    return { ...call, fullVisualization: matcher[call.data.slice(0, 10)](call) }\n  })\n\n  return newCalls\n}\n\nexport default AcrossModule\n"]}